module grayscale (
  input clk
  input en,
  input mode_gray,
  input mode_sat,
  input [7:0] in_R,
  input [7:0] in_G,
  input [7:0] in_B,
  output reg [7:0] out_R,
  output reg [7:0] out_G,
  output reg [7:0] out_B   
);

reg  [17:0]  LUM;
wire  [7:0]  VGA_LUM;

sat LUM_sat ({1'b0, LUM[17:9]}, VGA_LUM);

always @(*) begin
  out_R = in_R;
  out_G = in_G;
  out_B = in_B;
  
  if (en == 1'b1) begin
    LUM = (8'h55 * in_R) + (8'h55 * in_B) + (8'h55 * in_G); // .333
    if (mode_gray == 1'b1) begin
		LUM = (8'h36 * in_R) + (8'hB7 * in_B) + (8'h12 * in_G); // better values
    end
	 
	 out_R = LUM[17:10];
    out_G = LUM[17:10];
    out_B = LUM[17:10];
    if (mode_sat == 1'b1) begin
      out_R = VGA_LUM;
		out_G = VGA_LUM;
		out_B = VGA_LUM;
    end
  end
end
endmodule